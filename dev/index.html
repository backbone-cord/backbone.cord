<!DOCTYPE html>
<html>
<head>
	<style type="text/css">
	.square {
		background-color: blue;
		width: 100px;
		height: 100px;
		/*transition: all 0.1s;*/
		position: relative;
	}
	.red {
		background-color: red;
	}
	.red-true {
		background-color: red;
	}
	.red-false {
		background-color: #CCC;
	}
	.circle {
		height: 100px;
		width: 100px;
		border-radius: 50%;
		background-color: maroon;
		color: #FFF;
		text-align: center;
		position: relative;
	}
	</style>
</head>
<body>
	<script type="text/javascript">
		window.cordCompatibilityMode = true;
		window.cordDebug = true;
	</script>
	<script type="text/javascript" src="/underscore/underscore.js"></script>
	<script type="text/javascript" src="/jquery/dist/jquery.js"></script>
	<script type="text/javascript" src="/backbone/backbone.js"></script>
	<script type="text/javascript" src="/backbone.cord.js"></script>
	<script type="text/javascript">
	$(function() {
		window.Circle = Backbone.Cord.View.extend({
			el: function(el, view) {
				return el('._',
						el('#circle.circle', {style: {top: '{_top}px', left: '{_left}px'}}, '{lastName}'));
			},
			properties: {
				top: 0,
				left: 0
			},
			observers: {
				_top: Backbone.Events.trigger
			}
		});

		var Parent = Backbone.Cord.View.extend({
			className: 'parent',
			styles: {
				backgroundColor: '#999',
				color: '#333'
			}
		});

		var Square = Parent.extend({
			className: 'view',
			styles: {
				userSelect: 'none',
				backgroundColor: '#DDD',
				paddingLeft: '50px',
				border: '2px dotted {_borderColor}',
				boxShadow: '1px 2px 2px black',
				_container: {
					borderLeft: '10px solid black',
					borderBottom: ':={_left}*1.5=:px solid purple'
				},
				p: {
					color: 'olive'
				},
				tablet: {
					backgroundColor: 'orange',
				},
				mobile: {
					backgroundColor: 'green',
				}
			},
			el: function(h, s) {
				return h('', {onkeyup: 'alertKey'},
						h('select', {change: 'ls_color'},
							h('option', {value: 'purple'}, 'Purple'),
							h('option', {value: 'grey'}, 'Grey'),
							h('option', {value: 'blue'}, 'Blue')
						),
						h('input', {type: 'checkbox', change: '_message'}),
						h('input', {type: 'range', min: 0, max: 100, input: '_left', value: '{_left}'}),
						h('#container.square.red(_red)', {style: {borderTop: '{_left}px solid {ls_color}', top: '{_top}px', left: '{_left}px'}}),
						h('p',
							'Click the button below to change the color.', 'Distance is {_distance}.'),
						h('button#button', {onclick: 'onButtonClick'}, 'Click Me'),
						h('p.red-{_red}',
							'Red is: {_red}'),
						h('.hi', {style: {paddingLeft: ':={@cursorX}-200=:', paddingTop: ':={@cursorY}/2=:'}},
							'Hi {firstName}, Blue is: {_blue}'),
						h('p#thankyou', {hidden: '_red'},
							'Thank you much, {firstName} {lastName} aka {nickName}!'),
						h('input', {value: ' this is {$shared} world {_blue} hello {firstName}', change: '_message'}),
						h('a', {href: 'http://backbonejs.org', target: '_blank', onclick: function() { return false; } }, 'backbonejs.org'),
						s(Circle, '#circle', {style: {marginLeft: '{_left}'}, top: 'onCircleTop'}),
						s(Circle, '#circle2', {hidden: '_red', onclick: 'onButtonClick'}),
						s(Backbone.Cord.EmptyView, '#emptyView')
					);
			},
			properties: {
				blue: {
					value: 123,
					set: function(value) { this._blue = value + 100; }
				},
				red: true,
				blue: 123,
				message: {
					set: function(value) { this._message = value; console.log(value); }
				},
				top: 0,
				left: 10,
				borderColor: '#CCC',
				distance: function(_top, _left) { return _top + _left; },
				inherited: null,
				inheritedLastName: function(_inherited, lastName) { return _inherited || lastName; }
			},
			onButtonClick: function() {
				this.red = !this.red;
				this.blue = Math.floor(Math.random() * 100);
				this.el.appendChild(this._el('p', 'Thank you much, blue * 11 is :={_blue} * 11 - 5.6=: {lastName}! {_inheritedLastName}'));
			},
			onCircleTop: function(value) {
				console.log('onCircleTop ' + value);
			},
			alertKey: function(e) {
				console.log('keyup ' + e.keyCode);
				switch(e.keyCode) {
					case 37:
						this.left -= 10;
						this.circle.left -= 10;
						break;
					case 38:
						this.top -= 10;
						this.circle.top -= 10;
						break
					case 39:
						this.left += 10;
						this.circle.left += 10;
						break;
					case 40:
						this.top += 10;
						this.circle.top +=10;
						break;
				}
			}
		});
		window.squareModel = new Backbone.Model({firstName:'Carl', lastName:'Awesome', nickName:'Car'});
		window.square = new Square({model: squareModel});
		$(document.body).append(square.el);
		square.focus();
	});
	</script>
</body>
</html>
